<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>lst_filter — lst_filter • LSTtools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="lst_filter — lst_filter" />
<meta property="og:description" content="Filter pixels of MODIS LST products based on the
LST error and angle layers." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LSTtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/LSTtools-main-use.html">LSTtools package main use</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RichardLemoine/LSTtools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>lst_filter</h1>
    <small class="dont-index">Source: <a href='https://github.com/RichardLemoine/LSTtools/blob/master/R/modis_preprocessing.R'><code>R/modis_preprocessing.R</code></a></small>
    <div class="hidden name"><code>lst_filter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Filter pixels of MODIS LST products based on the
LST error and angle layers.</p>
    </div>

    <pre class="usage"><span class='fu'>lst_filter</span>(<span class='no'>x</span>, <span class='kw'>time</span> <span class='kw'>=</span> <span class='st'>"day"</span>, <span class='no'>flag</span>, <span class='no'>angle</span>, <span class='kw'>conv</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>.hdf MODIS file corresponding to a LST product.</p></td>
    </tr>
    <tr>
      <th>time</th>
      <td><p>A character specifying the time of the data to filter.
Possible values are "day" or "night".</p></td>
    </tr>
    <tr>
      <th>flag</th>
      <td><p>LST error bit flag or accuracy tolerance from 1-4.</p></td>
    </tr>
    <tr>
      <th>angle</th>
      <td><p>Viewing zenith angle tolerance to filter pixels (in degrees).</p></td>
    </tr>
    <tr>
      <th>conv</th>
      <td><p>Logical; if TRUE, units are converted to Celsius degrees.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of three raster layers: LST layer in Kelvin or
Celsius degrees, error or accuracy layer and viewing zenith
angle layer. Only pixels that are not NA in the original LST
layer are included in the error and view zenith angle layers.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Filter the pixels of a day or night data of a MODIS LST
product, based on tolerance values of LST error and zenith viewing
angle defined by the user. If parameter conv = TRUE, temperature
units are convert to Celsius degrees. This is the default. Products
MXD11_L2 and MYD21_L2 are not supported.</p>
<p>LST error bit flag to filter pixels must be defined as an integer
from 0-3 corresponding to: 0=00, 1=01, 2=10 and 3=11 in the 7 &amp; 6
bit flags for 8 bit QC layers and 15 &amp; 14 bit flags for 16 bit QC
layers. LST error flags differ between MXD11 and MXD21 products.
In MXD11 products, the flag represents average LST error values
in Kelvin degrees, with an increase of 1 degree. In MXD21 products,
the level of error is represented as accuracy in Kelvin degrees,
with increases of 0.5 degrees. See table 13 (MXD11; Wan, 2013) and
table 10 (MXD21; Hulley et al., 2016) in the MXD11 and MXD21 user
guides, respectively.</p>
<p>A negative sign of the viewing angle means MODIS viewing the grid
from east. The view zenith angle itself is always a positive number,
the zenith angle from nadir. The information of MODIS viewing
the grid from east or west may be important in understanding the
view angle effect in the temporal variations in LST, especially
in rugged regions.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hulley, G., Freepartner, R., Malakar, N. &amp; Sarkar, S.
(2016), Moderate Resolution Imaging Spectroradiometer (MODIS) - Land
Surface Temperature and Emissivity Product (MxD21) User Guide
Collection-6. Pasadena, EUA, 29.</p>
<p>Hulley, G., Hook, S., &amp; Hughes, C. (2012). MODIS MxD21 Land
Surface Temperature and Emissivity Algorithm Theoretical Basis
Document. In: Jet Propulsion Laboratory, California Institute
of Technology, JPL Publication 12-17, August, 2012.</p>
<p>Z. Wan, &amp; Z.-L. Li. (2011), Chapter 25, MODIS land surface temperature
and emissivity. In B. Ramachandran, C. O. Justice, &amp; M. J.
Abrams (Eds.), Land remote sensing and global environmental
change, NASA's Earth observing system and the science of ASTER
and MODIS, NASA's Earth observing system and the science of ASTER
and MODIS. New York Dordrecht Heidelberg London: Springer,
http://dx.doi.org/10.1007/978-1-4419-6749-7.</p>
<p>Z. Wan. (2013), Collection-6 MODIS Land Surface Temperature Products
User's guide. Santa Barbara, USA, 33.</p>
<p>Z. Wan, Y. Zhang, Q. Zhang, and Z.-L. Li. (2002), "Validation of
the land-surface temperature products retrieved from Terra Moderate
Resolution Imaging Spectroradiometer data", Remote Sens.
Environ., 83, 163-180.</p>
<p>Gawuc, L., &amp; Struzewska, J. (2016). Impact of MODIS quality
control on temporally aggregated urban surface temperature and
long-term surface urban heat island intensity. Remote Sensing,
8(5). https://doi.org/10.3390/rs8050374</p>
<p>Hu, L., Brunsell, N. A., Monaghan, A. J., Barlage, M.,
&amp; Wilhelmi, O. V. (2014). How can we use MODIS land surface
temperature to validate long-term urban model simulations?
Journal of Geophysical Research, 119(6), 3185-3201.
https://doi.org/10.1002/2013JD021101</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># For LST day MXD11 product, filtering pixels with LST error</span>
<span class='co'># &lt;= 1 and view zenith angle &lt;= 35</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='st'>"MOD11A1.A2019305.h14v09.006.2019306084028.hdf"</span>
<span class='no'>lstfiltered</span>  <span class='kw'>&lt;-</span> <span class='fu'>lst_filter</span>(<span class='no'>x</span>, <span class='kw'>time</span> <span class='kw'>=</span> <span class='st'>"day"</span>, <span class='kw'>flag</span>  <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>angle</span> <span class='kw'>=</span> <span class='fl'>35</span>, <span class='kw'>conv</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: comando ejecutado '"C:\Program Files\QGIS 3.10\bin\gdalinfo.exe" "MOD11A1.A2019305.h14v09.006.2019306084028.hdf"' tiene estatus 1</span></div><div class='output co'>#&gt; <span class='error'>Error in split1[[1]]: subíndice fuera de  los límites</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


